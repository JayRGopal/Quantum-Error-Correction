import numpy as np
import scipy.linalg as la


# Error Mitigation Matrix
M = [(.8877, .0787, .0776, .0131, .0747, .0146, .0162, .0073, .1303, .0121, .0151, .0071, .0143, .0068, .0076, .0187),
     (.0126, .8233, .0066, .0795, .0011, .0816, .0009, .0109, .0013, .0568, .0006, .0100, .0010, .0105, .0000, .0132),
     (.0216, .0051, .8245, .0819, .0039, .0010, .0836, .0059, .0059, .0014, .0773, .0057, .0004, .0001, .0109, .0108),
     (.0003, .0580, .0593, .7837, .0000, .0023, .0016, .0637, .0002, .0038, .0026, .0564, .0000, .0002, .0001, .0288),
     (.0593, .0021, .0013, .0003, .8320, .0744, .0774, .0094, .0090, .0002, .0008, .0002, .0555, .0086, .0066, .0098),
     (.0005, .0141, .0142, .0010, .0118, .7836, .0030, .0680, .0001, .0013, .0000, .0004, .0043, .0758, .0002, .0203),
     (.0016, .0001, .0004, .0022, .0557, .0020, .7761, .0775, .0009, .0000, .0015, .0000, .0013, .0005, .0562, .0254),
     (.0155, .0006, .0010, .0167, .0010, .0193, .0196, .7327, .0000, .0001, .0001, .0020, .0001, .0021, .0017, .1297),
     (.0002, .0011, .0136, .0001, .0015, .0001, .0004, .0001, .7563, .0735, .0731, .0089, .0728, .0065, .0081, .0135),
     (.0007, .0153, .0012, .0015, .0001, .0019, .0001, .0002, .0109, .7739, .0014, .0734, .0051, .0551, .0002, .0165),
     (.0000, .0013, .0003, .0024, .0001, .0001, .0019, .0002, .0261, .0052, .7841, .0725, .0015, .0001, .0705, .0170),
     (.0000, .0003, .0000, .0168, .0000, .0000, .0000, .0021, .0013, .0533, .0206, .7404, .0001, .0019, .0021, .0745),
     (.0000, .0000, .0000, .0001, .0165, .0023, .0013, .0003, .0540, .0022, .0021, .0002, .7693, .0636, .0721, .0190),
     (.0000, .0000, .0000, .0002, .0005, .0165, .0000, .0025, .0007, .0150, .0000, .0021, .0541, .7459, .0034, .0636),
     (.0000, .0000, .0000, .0002, .0011, .0000, .0176, .0029, .0030, .0001, .0201, .0032, .0189, .0034, .7387, .0800),
     (.0000, .0000, .0000, .0003, .0000, .0003, .0003, .0160, .0000, .0011, .0006, .0175, .0013, .0189, .0216, .4592)]

M = np.asarray(M)

Minv = la.inv(M)

diags = np.diagonal(M)